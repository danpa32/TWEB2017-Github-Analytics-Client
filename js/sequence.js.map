{"version":3,"sources":["sequence.js"],"names":["d3","window","quorom","width","height","radius","Math","min","b","w","h","s","t","colors","open","closed","defaultColors","vis","select","append","attr","partition","layout","size","PI","value","d","arc","svg","startAngle","x","endAngle","dx","innerRadius","sqrt","y","outerRadius","dy","getAncestors","node","path","current","parent","unshift","initializeBreadcrumbTrail","trail","style","breadcrumbPoints","i","points","push","join","updateBreadcrumbs","nodeArray","percentageString","g","selectAll","data","name","depth","entering","enter","rank","length","text","exit","remove","mouseover","textForClosed","textForOpen","percentageStr","sequenceArray","filter","indexOf","mouseleave","on","transition","duration","each","over","drawLegend","li","r","legend","keys","entries","key","toggleLegend","buildHierarchy","root","children","users","issues","issue","user","login","undefined","state","Object","forEach","states","currUserNode","currStateNode","getSize","reduce","total","e","sort","d1","d2","createVisualization","json","nodes","owner","repo","Date","date_crawl","toISOString","slice"],"mappings":"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","file":"sequence.js","sourcesContent":["/**\n * Modification of the source code found here : https://bl.ocks.org/kerryrodden/766f8f6d31f645c39f488a0befa1e3c8\n */\nconst { d3 } = window;\nconst quorom = 10;\n\n// Dimensions of sunburst.\nconst width = 750;\nconst height = 600;\nconst radius = Math.min(width, height) / 2;\n\n// Breadcrumb dimensions: width, height, spacing, width of tip/tail.\nconst b = {\n  w: 125, h: 30, s: 3, t: 10,\n};\n\n// Mapping of step names to colors.\nconst colors = {\n  open: '#32e875',\n  closed: '#c06c7f',\n};\n\nconst defaultColors = ['#6ca0f1', '#357ded'];\n\nconst vis = d3.select('#chart').append('svg:svg')\n  .attr('width', width)\n  .attr('height', height)\n  .append('svg:g')\n  .attr('id', 'container')\n  .attr('transform', `translate(${width / 2},${height / 2})`);\n\nconst partition = d3.layout.partition()\n  .size([2 * Math.PI, radius * radius])\n  .value(d => d.size);\n\nconst arc = d3.svg.arc()\n  .startAngle(d => d.x)\n  .endAngle(d => d.x + d.dx)\n  .innerRadius(d => Math.sqrt(d.y))\n  .outerRadius(d => Math.sqrt(d.y + d.dy));\n\n// Given a node in a partition layout, return an array of all of its ancestor\n// nodes, highest first, but excluding the root.\nfunction getAncestors(node) {\n  const path = [];\n  let current = node;\n  while (current.parent) {\n    path.unshift(current);\n    current = current.parent;\n  }\n  return path;\n}\n\nfunction initializeBreadcrumbTrail() {\n  // Add the svg area.\n  const trail = d3.select('#sequence').append('svg:svg')\n    .attr('width', width)\n    .attr('height', 50)\n    .attr('id', 'trail');\n  // Add the label at the end, for the percentage.\n  trail.append('svg:text')\n    .attr('id', 'endlabel')\n    .style('fill', '#000');\n}\n\n// Generate a string that describes the points of a breadcrumb polygon.\nfunction breadcrumbPoints(d, i) {\n  const points = [];\n  points.push('0,0');\n  points.push(`${b.w},0`);\n  points.push(`${b.w + b.t},${b.h / 2}`);\n  points.push(`${b.w},${b.h}`);\n  points.push(`0,${b.h}`);\n  if (i > 0) { // Leftmost breadcrumb; don't include 6th vertex.\n    points.push(`${b.t},${b.h / 2}`);\n  }\n  return points.join(' ');\n}\n\n// Update the breadcrumb trail to show the current sequence and percentage.\nfunction updateBreadcrumbs(nodeArray, percentageString) {\n  // Data join; key function combines name and depth (= position in sequence).\n  const g = d3.select('#trail')\n    .selectAll('g')\n    .data(nodeArray, d => d.name + d.depth);\n\n  // Add breadcrumb and label for entering nodes.\n  const entering = g.enter().append('svg:g');\n\n  entering.append('svg:polygon')\n    .attr('points', breadcrumbPoints)\n    .style('fill', d => colors[d.name] || defaultColors[d.rank % defaultColors.length]);\n\n  entering.append('svg:text')\n    .attr('x', (b.w + b.t) / 2)\n    .attr('y', b.h / 2)\n    .attr('dy', '0.35em')\n    .attr('text-anchor', 'middle')\n    .text(d => d.name);\n\n  // Set position for entering and updating nodes.\n  g.attr('transform', (d, i) => `translate(${i * (b.w + b.s)}, 0)`);\n\n  // Remove exiting nodes.\n  g.exit().remove();\n\n  // Now move and update the percentage at the end.\n  d3.select('#trail').select('#endlabel')\n    .attr('x', (nodeArray.length + 0.5) * (b.w + b.s))\n    .attr('y', b.h / 2)\n    .attr('dy', '0.35em')\n    .attr('text-anchor', 'middle')\n    .text(percentageString);\n\n  // Make the breadcrumb trail visible, if it's hidden.\n  d3.select('#trail')\n    .style('visibility', '');\n}\n\n// Fade all but the current sequence, and show it in the breadcrumb trail.\nfunction mouseover(d) {\n  const percentageString = `${d.value}`;\n  const textForClosed = ' of them have been ';\n  const textForOpen = ' of them are still ';\n\n  const percentageStr = ' issues have been created by ';\n\n  switch (d.name) {\n    case 'open':\n      d3.select('#percentage')\n        .text(d.value);\n      d3.select('#info-text-nbIssues')\n        .text(textForOpen)\n        .style('font-size', '1em');\n      d3.select('#info-text-info-repo')\n        .text(`${d.name}ed`);\n      break;\n    case 'closed':\n      d3.select('#percentage')\n        .text(d.value);\n      d3.select('#info-text-nbIssues')\n        .text(textForClosed)\n        .style('font-size', '1em');\n      d3.select('#info-text-info-repo')\n        .text(d.name);\n      break;\n    default:\n      d3.select('#percentage')\n        .text(percentageString);\n      d3.select('#info-text-nbIssues')\n        .text(percentageStr)\n        .style('font-size', '1em');\n      d3.select('#info-text-info-repo')\n        .text(`${d.name}.`);\n  }\n\n  d3.select('#explanation')\n    .style('top', '240px');\n\n  const sequenceArray = getAncestors(d);\n  updateBreadcrumbs(sequenceArray, percentageString);\n\n  // Fade all the segments.\n  d3.selectAll('path')\n    .style('opacity', 0.3);\n\n  // Then highlight only those that are an ancestor of the current segment.\n  vis.selectAll('path')\n    .filter(node => (sequenceArray.indexOf(node) >= 0))\n    .style('opacity', 1);\n}\n\n// Restore everything to full opacity when moving off the visualization.\nfunction mouseleave() {\n  // Hide the breadcrumb trail\n  d3.select('#trail')\n    .style('visibility', 'hidden');\n\n  // Deactivate all segments during transition.\n  d3.selectAll('path').on('mouseover', null);\n\n  // Transition each segment to full opacity and then reactivate it.\n  d3.selectAll('path')\n    .transition()\n    .duration(1000)\n    .style('opacity', 1)\n    .each('end', function over() {\n      d3.select(this).on('mouseover', mouseover);\n    });\n\n  d3.select('#percentage')\n    .text('');\n\n  d3.select('#info-text-nbIssues')\n    .text('Touch me !')\n    .style('font-size', '2.5em');\n\n  d3.select('#info-text-info-repo')\n    .text('');\n\n  d3.select('#explanation')\n    .style('top', '210px');\n}\n\nfunction drawLegend() {\n  // Dimensions of legend item: width, height, spacing, radius of rounded rect.\n  const li = {\n    w: 75, h: 30, s: 3, r: 3,\n  };\n\n  const legend = d3.select('#legend').append('svg:svg')\n    .attr('width', li.w)\n    .attr('height', d3.keys(colors).length * (li.h + li.s));\n\n  const g = legend.selectAll('g')\n    .data(d3.entries(colors))\n    .enter().append('svg:g')\n    .attr('transform', (d, i) => `translate(0,${i * (li.h + li.s)})`);\n\n  g.append('svg:rect')\n    .attr('rx', li.r)\n    .attr('ry', li.r)\n    .attr('width', li.w)\n    .attr('height', li.h)\n    .style('fill', d => d.value);\n\n  g.append('svg:text')\n    .attr('x', li.w / 2)\n    .attr('y', li.h / 2)\n    .attr('dy', '0.35em')\n    .attr('text-anchor', 'middle')\n    .text(d => d.key);\n}\n\nfunction toggleLegend() {\n  const legend = d3.select('#legend');\n  if (legend.style('visibility') === 'hidden') {\n    legend.style('visibility', '');\n  } else {\n    legend.style('visibility', 'hidden');\n  }\n}\n\nfunction buildHierarchy(data) {\n  const root = { name: 'root', children: [] };\n  const users = {};\n  for (let i = 0; i < data.issues.length; i += 1) {\n    const issue = data.issues[i];\n    if (users[issue.user.login] === undefined) {\n      users[issue.user.login] = {};\n    }\n\n    if (users[issue.user.login][issue.state] === undefined) {\n      users[issue.user.login][issue.state] = [];\n    }\n    users[issue.user.login][issue.state].push(issue);\n  }\n\n  Object.entries(users).forEach(([login, states]) => {\n    let size = 0;\n    const currUserNode = { name: login, children: [] };\n\n    Object.entries(states).forEach(([state, issues]) => {\n      size += issues.length;\n      const currStateNode = { name: state, size: issues.length };\n      currUserNode.children.push(currStateNode);\n    });\n\n    if (size >= quorom) {\n      root.children.push(currUserNode);\n    }\n  });\n\n  function getSize(d) {\n    let size = 0;\n\n    if (d.children !== undefined) {\n      size = d.children.reduce((total, e) => total + getSize(e), 0);\n    }\n\n    if (d.size !== undefined) {\n      size += d.size;\n    }\n    return size;\n  }\n\n  root.children.sort((d1, d2) => getSize(d2) - getSize(d1));\n  for (let i = 0; i < root.children.length; i += 1) {\n    root.children[i].rank = i;\n  }\n  return root;\n}\n\n// Main function to draw and set up the visualization, once we have the data.\nfunction createVisualization(json) {\n  // Basic setup of page elements.\n  initializeBreadcrumbTrail();\n  drawLegend();\n  d3.select('#togglelegend').on('click', toggleLegend);\n\n  // Bounding circle underneath the sunburst, to make it easier to detect\n  // when the mouse leaves the parent g.\n  vis.append('svg:circle')\n    .attr('r', radius)\n    .style('opacity', 0);\n\n  // For efficiency, filter nodes to keep only those large enough to see.\n  const nodes = partition.nodes(json)\n    .filter(d => (d.dx > 0.005)); // 0.005 radians = 0.29 degrees\n\n  vis.data([json]).selectAll('path')\n    .data(nodes)\n    .enter()\n    .append('svg:path')\n    .attr('display', d => (d.depth ? null : 'none'))\n    .attr('d', arc)\n    .attr('fill-rule', 'evenodd')\n    .style('fill', d => colors[d.name] || defaultColors[d.rank % defaultColors.length])\n    .style('opacity', 1)\n    .on('mouseover', mouseover);\n\n  // Add the mouseleave handler to the bounding circle.\n  d3.select('#container').on('mouseleave', mouseleave);\n}\n\nd3.json('repo.json', (data) => {\n  d3.select('#header-repo-name')\n    .text(`${data.owner}/${data.repo}`);\n\n  d3.select('#header-nb-issues')\n    .text(data.issues.length);\n\n  d3.select('#info-crawl')\n    .text(new Date(data.date_crawl).toISOString().slice(0, 10));\n\n  const json = buildHierarchy(data);\n  createVisualization(json);\n});\n"]}